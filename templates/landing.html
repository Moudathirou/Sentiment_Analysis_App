<html><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sentiment Analysis App</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .gradient-bg {
      background: linear-gradient(90deg, #4b6cb7 0%, #182848 100%);
    }
    .card {
      background-color: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen">
  <header class="gradient-bg text-white py-6">
    <div class="container mx-auto px-4">
      <h1 class="text-4xl font-bold">Sentiment Analysis Dashboard</h1>
      <p class="mt-2">Uncover the emotions behind the words</p>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <section class="card rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-semibold mb-4">Single Text Analysis</h2>
        <form id="singlePredictionForm" class="space-y-4">
          <div>
            <label for="modelSelector" class="block text-sm font-medium text-gray-700">Choose Model</label>
            <select id="modelSelector" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
              <option value="Voting">Voting Classifier</option>
              <option value="Stacking">Stacking Classifier</option>
              <option value="LLM">LLM</option>
              <option value="rf">CNN Model</option>
            </select>
          </div>
          <div>
            <label for="textInput" class="block text-sm font-medium text-gray-700">Enter Text</label>
            <textarea id="textInput" rows="4" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 mt-1 block w-full sm:text-sm border border-gray-300 rounded-md" placeholder="Type your text here..."></textarea>
          </div>
          <button type="button" onclick="predict()" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            Analyze
          </button>
        </form>
        <div id="singlePredictionResult" class="mt-4 p-4 bg-white rounded-md shadow"></div>
      </section>

      <section class="card rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-semibold mb-4">Bulk CSV Analysis</h2>
        <form id="csvUploadForm" class="space-y-4">
          <div>
            <label for="csvFile" class="block text-sm font-medium text-gray-700">Upload CSV File</label>
            <input type="file" id="csvFile" accept=".csv" class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100">
          </div>
          <button type="button" onclick="uploadCSV()" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
            Upload & Analyze
          </button>
        </form>
        <div id="csvAnalysisResult" class="mt-4">
          <canvas id="sentimentChart" width="400" height="200"></canvas>
        </div>
      </section>
    </div>

    <section class="mt-8 card rounded-lg shadow-lg p-6">
      <h2 class="text-2xl font-semibold mb-4">Analysis Results</h2>
      <div class="overflow-x-auto">
        <table id="resultsTable" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Text</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentiment</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200" id="resultsTableBody">
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <script>
    let sentimentChart;

    function predict() {
      const text = document.getElementById('textInput').value;
      const model = document.getElementById('modelSelector').value;
      fetch('http://localhost:5000/predict', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ text, model })
      })
      .then(response => response.json())
      .then(data => {
        document.getElementById('singlePredictionResult').textContent = `Sentiment: ${data.prediction}`;
        updateResultsTable([{ text, sentiment: data.prediction }]);
      })
      .catch(error => console.error('Error:', error));
    }

    function uploadCSV() {
      const file = document.getElementById('csvFile').files[0];
      const formData = new FormData();
      formData.append('file', file);

      fetch('http://localhost:5000/upload_csv', {
        method: 'POST',
        body: formData
      })
      .then(response => response.json())
      .then(data => {
        updateSentimentChart(data.graph);
        const csvData = data.csv_data.split('\n').slice(1).map(row => {
          const [text, sentiment] = row.split(',');
          return { text, sentiment };
        });
        updateResultsTable(csvData);
      })
      .catch(error => console.error('Error:', error));
    }

    function updateSentimentChart(graphData) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) {
        sentimentChart.destroy();
      }
      sentimentChart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ['Positive', 'Negative', 'Neutral'],
          datasets: [{
            data: [30, 50, 20], // Replace with actual data
            backgroundColor: ['#4CAF50', '#F44336', '#FFC107']
          }]
        },
        options: {
          responsive: true,
          title: {
            display: true,
            text: 'Sentiment Distribution'
          }
        }
      });
    }

    function updateResultsTable(data) {
      const tableBody = document.getElementById('resultsTableBody');
      tableBody.innerHTML = '';
      data.forEach(item => {
        const row = tableBody.insertRow();
        const textCell = row.insertCell(0);
        const sentimentCell = row.insertCell(1);
        textCell.textContent = item.text;
        sentimentCell.textContent = item.sentiment;
      });
    }
  </script>
</body></html>